---

title: "Inventory System ì´í•´í•˜ê¸°"
author: Manyeo
categories: 
- Unity
tags: 
- Code Analysis

date: 2021-12-29

---

Code by Rito15


<br>


# ì‹œì‘

> RPG Inventory Systemì„ í•œì¤„ í•œì¤„ ë¶„ì„í•œë‹¤.

<br>

# êµ¬ì„±

> ë¶„ì„ í›„ì— ì •ë¦¬í•˜ë„ë¡ í•œë‹¤.

<br>


# ì½”ë“œ ë¶„ì„

## ğŸ“œItem.cs

<br>

```cs
public abstract class Item
{
    public ItemData Data { get; private set; }

    public Item(ItemData data) => Data = data;
}
```

`Item` Classì˜ ë³¸ë¬¸ì´ë‹¤.

<br>

```cs
 public abstract class Item
```

`Item` í´ë˜ìŠ¤ë¥¼ ì¶”ìƒ í´ë˜ìŠ¤ (`abstract class`)ë¡œ ì„ ì–¸í•œë‹¤.

ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì„ ì–¸í•˜ëŠ” ì´ìœ ëŠ” ìƒì†ë°›ì„ ìì‹ í´ë˜ìŠ¤(**`Child Class`**)ì—ì„œ ì¶”ìƒ ë©”ì„œë“œ(**`abstract method`**)ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ëª©ì ì¼ ë•Œ ì“°ì´ëŠ”ë° ì—¬ê¸°ì„  ì™œ ì“°ê±´ì§€ ëª¨ë¥´ê² ë‹¤. ~~ë¶€ëª¨ í´ë˜ìŠ¤ë¡œì„œ ì“°ì¼ ê²ƒì´ê¸° ë•Œë¬¸ì— êµ¬í˜„ì€ ìì‹ í´ë˜ìŠ¤ì— ë§¡ê¸°ë ¤ê³  í•œ ê²ƒì¼ ìˆ˜ë„ ìˆê² ë‹¤. `abstract`ë¥¼ **ì‚¬ìš©ì˜ ëª©ì **ë³´ë‹¤ **í‘œì‹œì˜ ëª©ì **ìœ¼ë¡œ ì“´ ê²ƒìœ¼ë¡œ ìƒê°í•˜ì.~~

ë˜í•œ, `Monobehaviour`ë¥¼ ìƒì†í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ ì»´í¬ë„ŒíŠ¸ë¡œì„œ ê¸°ëŠ¥í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. 

<u>+*ì¶”ê°€* : ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì‚¬ìš©í•œ ì´ìœ ëŠ” ì§ì ‘ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•¨ì´ë‹¤. ìì‹ í´ë˜ìŠ¤ì—ì„œë„ `Monobehaviour`ë¥¼ ìƒì†í•˜ì§€ ì•Šê¸° ë•Œë¬¸.</u>

<br>

```cs
public ItemData Data { get; private set; }
```

`ItemData` í˜•ì‹ì˜ í”„ë¡œí¼í‹° Dataë¥¼ ì„ ì–¸í•œë‹¤. 

í”„ë¡œí¼í‹°ê¸° ë•Œë¬¸ì— ì ‘ê·¼ í•œì •ìëŠ”  `public`ìœ¼ë¡œ ì„¤ì •í•œë‹¤. í”„ë¡œí¼í‹°ë¡œ ì„¤ì •í•œ ê²ƒì€ `getter`ì™€ `setter` í•¨ìˆ˜ ëŒ€ì‹ ì— ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. setterëŠ” `private`ìœ¼ë¡œ ì„¤ì •í•´ì„œ ì™¸ë¶€ì—ì„œ ê°’ì„ ë„£ì„ ìˆ˜ëŠ” ì—†ê²Œ í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì•„ë˜ëŠ” í•´ë‹¹ í”„ë¡œí¼í‹°ë¥¼ í•¨ìˆ˜ë¡œ ì¹˜í™˜í•œ ê²ƒì´ë‹¤.




```cs
public ItemData GetData();
private ItemData SetData(value);
```

`ItemData`ëŠ” ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì˜ ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤ì´ë¯€ë¡œ ì¢€ ìˆë‹¤ê°€ ì„œìˆ í•˜ê² ë‹¤.

<br>


```cs
public Item(ItemData data) => Data = data;
```

`Item` í´ë˜ìŠ¤ì˜ ìƒì„±ì(**`Constructor`**)ë¥¼ ì„ ì–¸í•œë‹¤.

ìƒì„±ì ë§¤ê°œë³€ìˆ˜ë¡œ `ItemData` í˜•ì‹ì˜ dataë³€ìˆ˜ë¥¼ ë°›ê³  Data í”„ë¡œí¼í‹° ê°’ì„ data ë§¤ê°œë³€ìˆ˜ ê°’ìœ¼ë¡œ ì´ˆê¸°í™” í•œë‹¤. ë”± ë´¤ì„ ë•ŒëŠ” ëŒë‹¤ ì‹(`Lambda Expression`)ìœ¼ë¡œ ë³´ì´ì§€ë§Œ ì‚¬ì‹¤ ëŒë‹¤ëŠ” ì•„ë‹ˆê³ , ëŒë‹¤ì˜ í˜•íƒœë¥¼ ë©¤ë²„ì—ì„œ ì“°ëŠ” **ì‹ ë³¸ë¬¸ ë©¤ë²„**(`Expression-bodied members`)ë¬¸ë²•ì´ë‹¤. C# 6ê³¼ C# 7.0 ì´ìƒë¶€í„° ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. ì›ë˜ ë¬¸ì¥ìœ¼ë¡œ ë°”ê¾¸ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```cs
// public Item(ItemData data) => Data = data;ì™€ ì™„ì „íˆ ê°™ì€ ë¬¸ì¥ì´ë‹¤.
// í”„ë¡œê·¸ë˜ë¨¸ì˜ ê·€ì°¨ë‹ˆì¦˜ì€ ëì´ ì—†ë‹¤.
public Item(ItemData data) 
{
    Data = data;
}
```

**ì‹ ë³¸ë¬¸ ë©¤ë²„**ëŠ” ìƒì„±ìë§Œì´ ì•„ë‹ˆë¼ í”„ë¡œí¼í‹°, ì¢…ë£Œì, ì¸ë±ì„œ, ë©”ì„œë“œ ì „ë¶€ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

<br>

## ğŸ“œEquipmentItem.cs

<br>

`Item` í´ë˜ìŠ¤ëŠ” ë‘ ê°œì˜ ìì‹ í´ë˜ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ê·¸ ì¤‘ í•˜ë‚˜ì¸ `EquipmentItem`ì„ ë¨¼ì € ì‚´í´ë³´ì.

```cs
public abstract class EquipmentItem : Item
{
    public EquipmentItemData EquipmentData { get; private set; }

    public int Durability
    {
        get => _durability;
        set
        {
            if (value < 0) value = 0;
            if (value > EquipmentData.MaxDurability)
                value = EquipmentData.MaxDurability;

            _durability = value;
        }
    }
    private int _durability;

    public EquipmentItem(EquipmentItemData data) : base(data)
    {
        EquipmentData = data;
        Durability = data.MaxDurability;
    }
}
```

`EquipmentItem` í´ë˜ìŠ¤ì˜ ë³¸ë¬¸ì´ë‹¤.

<br>

```cs
public abstract class EquipmentItem : Item
```

`EquipmentItem` í´ë˜ìŠ¤ë¥¼ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì„ ì–¸í•œë‹¤. `Item` í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ”ë‹¤.

`Item` í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ìœ¼ë©´ì„œ `Item` í´ë˜ìŠ¤ì˜ í•„ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. í•„ë“œë¡œ ì‚¬ìš©ëœ Dataì™€ ìƒì„±ìê°€ í´ë˜ìŠ¤ ìœ„ì— ì¶”ê°€ ë˜ì—ˆë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.

<br>

```cs
public EquipmentItemData EquipmentData { get; private set; }
```
`EquipmentItemData`í˜•ì‹ì˜ í”„ë¡œí¼í‹° EquipmentDataë¥¼ ì„ ì–¸í•œë‹¤.

<br>

```cs
public int Durability
{
    get => _durability;
    set
    {
        if (value < 0) value = 0;
        if (value > EquipmentData.MaxDurability)
            value = EquipmentData.MaxDurability;

        _durability = value;
    }
}
```
`int` í˜•ì‹ì˜ í”„ë¡œí¼í‹° Durabilityë¥¼ ì„ ì–¸í•œë‹¤.

DurabilityëŠ” 'ë‚´êµ¬ì„±'ì„ ëœ»í•˜ë¯€ë¡œ ì¥ë¹„ì˜ ë‚´êµ¬ë„ì— ê´€ë ¨ëœ í”„ë¡œí¼í‹°ì¼ ê²ƒì´ë‹¤. ìš°ì„  `getter`ë¡œ ë©¤ë²„ë³€ìˆ˜ _durabilityë¥¼ ê°€ì ¸ì˜¨ë‹¤. _durabilityëŠ” ì´ ì‹ì˜ ë‹¤ìŒì— ì„ ì–¸ë˜ë¯€ë¡œ í•´ë§¤ì§€ ë§ì. 

`setter`ì—ì„œ `value`ê°€ 0ë³´ë‹¤ ì‘ìœ¼ë©´ `value`ì— 0ì„ ëŒ€ì…í•˜ê³  `value`ê°€ `EquipmentData.MaxDurability`ë³´ë‹¤ í¬ë©´ `value`ì— EquipmentData.MaxDurabilityë¥¼ ëŒ€ì…í•œë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ _durability ë©¤ë²„ ë³€ìˆ˜ì— valueë¥¼ ëŒ€ì…í•œë‹¤.

ìµœì†Œê°’ê³¼ ìµœëŒ€ê°’ì„ ë²—ì–´ë‚˜ì§€ ì•Šê²Œ í•˜ëŠ” ì½”ë“œë‹¤. EquipmentData.MaxDurabilityëŠ” ìµœëŒ€ ë‚´êµ¬ë„ë¥¼ ê°€ì ¸ì˜¤ëŠ” í”„ë¡œí¼í‹°ë‹¤.

<br>

```cs
private int _durability;
```

`int` í˜•ì‹ì˜ ë©¤ë²„ë³€ìˆ˜ _durabilityë¥¼ ì„ ì–¸í•œë‹¤.

ë‚´êµ¬ë„ ê°’ì„ ì €ì¥í•  ë³€ìˆ˜ë¡œ ì“°ì¼ ëª©ì ìœ¼ë¡œ ì„ ì–¸ëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. Durability í”„ë¡œí¼í‹°ê°€ ì´ ë©¤ë²„ë³€ìˆ˜ì˜ ê°’ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ì €ì¥í•  ë•Œ ì• ìš©í•  ê²ƒì´ë‹¤. ë³€ìˆ˜ëª… ì•ì— _ (`Underscore`)ê°€ ë¶™ì€ ê²ƒì€ `ë©¤ë²„`ë³€ìˆ˜ë¼ì„œ ê·¸ë ‡ë‹¤. ì¼ë°˜ ë³€ìˆ˜ëŠ” ë¶™ì´ì§€ ì•ŠëŠ”ë‹¤. ì¼ì¢…ì˜ ì½”ë“œ ê·œì¹™ (`Code Convention`)ì´ë‹¤. ë‚´ê°€ í•˜ëŠ” ì½”ë“œë°©ì‹ê³¼ ìœ ì‚¬í•´ì„œ ì¢€ ë†€ë¬ë‹¤.

<br>

```cs
public EquipmentItem(EquipmentItemData data) : base(data)
{
    EquipmentData = data;
    Durability = data.MaxDurability;
}
```

`EquipmentItem` í´ë˜ìŠ¤ì˜ ìƒì„±ì(**`Constructor`**)ë¥¼ ì„ ì–¸í•œë‹¤.

ìš°ì„  `base(data)`ë¥¼ ìƒì†í•˜ê³  ìˆìœ¼ë¯€ë¡œ ë¶€ëª¨ì˜ ìƒì„±ìë¥¼ ë¨¼ì € í˜¸ì¶œí•œ ë’¤ ìì‹ ì˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•œë‹¤. ë”°ë¼ì„œ `Item` í´ë˜ìŠ¤ì˜ Data í”„ë¡œí¼í‹°ì— dataë¡œ ì´ˆê¸°í™”ê°€ ì§„í–‰ëœë‹¤.

ê·¸ëŸ° ë‹¤ìŒ EquipmentData í”„ë¡œí¼í‹°ì— ë§¤ê°œë³€ìˆ˜ dataë¡œ ì´ˆê¸°í™”í•˜ê³  Durability í”„ë¡œí¼í‹°ì— data.MaxDurabilityë¡œ ì´ˆê¸°í™”í•œë‹¤. ë°ì´í„°ë¥¼ ëª¨ë‘ ì´ˆê¸°í™” í•¨ê³¼ ë™ì‹œì— ë‚´êµ¬ë„ëŠ” ìµœëŒ€ ë‚´êµ¬ë„ë¡œ ì„¤ì •ì´ ëœë‹¤.

<br>

## ğŸ“œCountableItem.cs

<br>

```cs
public abstract class CountableItem : Item
{
    public CountableItemData CountableData { get; private set; }

    public int Amount { get; protected set; }

    public int MaxAmount => CountableData.MaxAmount;

    public bool IsMax => Amount >= CountableData.MaxAmount;

    public bool IsEmpty => Amount <= 0;


    public CountableItem(CountableItemData data, int amount = 1) : base(data)
    {
        CountableData = data;
        SetAmount(amount);
    }


    public void SetAmount(int amount)
    {
        Amount = Mathf.Clamp(amount, 0, MaxAmount);
    }


    public int AddAmountAndGetExcess(int amount)
    {
        int nextAmount = Amount + amount;
        SetAmount(nextAmount);

        return (nextAmount > MaxAmount) ? (nextAmount - MaxAmount) : 0;
    }


    public CountableItem SeperateAndClone(int amount)
    {
        if (Amount <= 1) return null;

        if (amount > Amount - 1)
            amount = Amount - 1;

        Amount -= amount;
        return Clone(amount);
    }

    protected abstract CountableItem Clone(int amount);
}
```

`CountableItem` í´ë˜ìŠ¤ì˜ ë³¸ë¬¸ì´ë‹¤.

<br>

```cs
public abstract class CountableItem : Item
```

`CountableItem` í´ë˜ìŠ¤ë¥¼ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì„ ì–¸í•œë‹¤. `Item` í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ”ë‹¤.
`EquipmentItem` í´ë˜ìŠ¤ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì‘ì„± ë˜ì–´ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

<br>

```cs
public CountableItemData CountableData { get; private set; }
```

`CountableItemData` í˜•ì‹ì˜ í”„ë¡œí¼í‹° CountableDataë¥¼ ì„ ì–¸í•œë‹¤.